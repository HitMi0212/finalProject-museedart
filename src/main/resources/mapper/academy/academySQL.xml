<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="academy">
  <insert id="academyInsert" parameterType="ac">
		insert 
			into academy
			values(academy_seq.nextval,#{academyTitle},#{academyStart},
			#{academyEnd},#{academyPhoto},#{academyTeacher},#{academyPlace},#{academyPrice},
			#{academyDetail},#{academyCategory})
	</insert>
	<select id="acadeyTotal" resultType="_int">
  		select count(*) from academy
  	</select>
  	<select id="academyList" parameterType="ap" resultType="ac">
		  		select 
		  			nn.academy_no as academyNo,
		  			nn.academy_title as academyTitle,
		  			nn.academy_start as academyStart,
		  			nn.academy_end as academyEnd,
		  			nn.academy_photo as academyPhoto,
		  			nn.academy_teacher as academyTeacher,
		  			nn.academy_place as academyPlace,
		  			nn.academy_price as academyPrice,
		  			nn.academy_detail as academyDetail,
		  			nn.academy_category as academyCategory
		  		from (select rownum as rnum,n.* from(select * from  academy order by academy_no desc)n)nn where rnum between  #{start} and #{end}
	</select>
	<select id ="selectCategoryList" parameterType="ap" resultType="ac">	
  				select 
		  			nn.academy_no as academyNo,
		  			nn.academy_title as academyTitle,
		  			nn.academy_start as academyStart,
		  			nn.academy_end as academyEnd,
		  			nn.academy_photo as academyPhoto,
		  			nn.academy_teacher as academyTeacher,
		  			nn.academy_place as academyPlace,
		  			nn.academy_price as academyPrice,
		  			nn.academy_detail as academyDetail,
		  			nn.academy_category as academyCategory
		  		from (select rownum as rnum,n.* from(select * from  academy where academy_category=#{category}  order by academy_no desc)n)nn where rnum between  #{start} and #{end}
	</select>
  	<select id="selectOneAcademy" parameterType="_int" resultType="ac">
  	 	select 
  			academy_no as academyNo,
  			academy_title as academyTitle,
  			academy_start as academyStart,
  			academy_end as academyEnd,
  			academy_photo as academyPhoto,
  			academy_teacher as academyTeacher,
  			academy_place as academyPlace,
  			academy_price as academyPrice,
  			academy_detail as academyDetail,
  			academy_category as academyCategory
  		from academy where academy_no = #{academyNo}
  	</select>
  	<select id="searchAcademyList" parameterType="ap" resultType="ac">
  		select 
		  			nn.academy_no as academyNo,
		  			nn.academy_title as academyTitle,
		  			nn.academy_start as academyStart,
		  			nn.academy_end as academyEnd,
		  			nn.academy_photo as academyPhoto,
		  			nn.academy_teacher as academyTeacher,
		  			nn.academy_place as academyPlace,
		  			nn.academy_price as academyPrice,
		  			nn.academy_detail as academyDetail,
		  			nn.academy_category as academyCategory
	from (select rownum as rnum,n.* from(select * from  academy where academy_title like '%'||#{category}||'%' or academy_detail like '%'||#{category}||'%' order by academy_no desc)n)nn 
	where rnum between  #{start} and #{end}
  	</select>
  	<insert id="academyCredit" parameterType="acp">
		insert
			into payment
			values(#{paymentNo},#{paymentSelect},#{academyNo},0,#{paymentPrice},
			to_char(sysdate,'YYYY-MM-DD'),0,#{paymentQuantity},null,#{memberNo})
	</insert>
	<select id="academyCategory" resultType="acc">
		select distinct(academy_category) as academyCategory from academy
	</select>
	<select id="totalCountAcademy" parameterType="string" resultType="_int">
		select count(*) from academy where academy_category=#{category}
	</select>
	<select id="searchAcademyTotal" parameterType="string" resultType="_int">
		select count(*) from academy where academy_title like '%'||#{keyWord}||'%' or academy_detail like '%'||#{keyWord}||'%'
	</select>
	<update id="academyUpdate" parameterType="ac">
		update academy set academy_title = #{academyTitle},academy_start = #{academyStart}, academy_end = #{academyEnd}, academy_photo=#{academyPhoto}, academy_teacher=#{academyTeacher}
			,academy_place = #{academyPlace}, academy_price=#{academyPrice},academy_detail=#{academyDetail},academy_category=#{academyCategory} where academy_no=#{academyNo}
	</update>
</mapper>
